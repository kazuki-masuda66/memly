/**
 * フラッシュカード生成用のプロンプトテンプレート
 * @param text 元テキスト
 * @param range 出題範囲・トピック
 * @param questionCount 問題数（'auto'|'max'|数値）
 * @param complexity 複雑さ（'simple'|'medium'|'detailed'）
 * @param language 言語コード（'ja'|'en'など）
 * @returns フォーマット済みプロンプト
 */
export const createFlashcardsPrompt = (
  text: string,
  range: string,
  questionCount: string | number,
  complexity: string,
  language: string
): string => {
  return `あなたはフラッシュカード作成のアシスタントAIです。

以下の情報をもとに、フラッシュカードを作成してください。

【元テキスト】:
${text}

【出題範囲・トピック】:
${range}

【問題数】:
${questionCount}
- 数値が指定されている場合はその数だけ作成してください。
- 「auto」の場合は、テキストの長さと内容に応じて適切な枚数を自動で決めてください。テキストの本質的な概念・重要ポイントを漏れなく抽出し、各重要概念に対して少なくとも1つのフラッシュカードを作成してください。
- 「max」の場合は、テキストから抽出できる可能な限り多くの問題を作成してください。テキストの内容を十分に網羅するように努めてください。テキスト内の重要な概念、用語定義、因果関係、例示、事実、分析ポイントなど、学習に役立つあらゆる要素を独立したフラッシュカードとして作成してください。

【複雑さ】:
${complexity}
- 「simple」→ 問題文、回答ともにシンプルかつ短め（1～2文程度）
- 「medium」→ ポイントをしっかり押さえた説明（2～4文程度）、例を用意する
- 「detailed」→ 詳細な解説や補足情報、必要に応じて箇条書き・複数例を挙げるなどして詳しく（4文以上など）

【言語】:
${language}
- 出力する際のメインの説明や質問文はこの言語をベースにしてください。
- もし言語が「ja」（日本語）で、テキストが英語の場合は、それをすべて日本語に翻訳するのではなく、英語のまま活用しながら（問題文や例文などに英語を残す）、必要な解説や案内は日本語で加えてください。これは英語を学ぶための問題として扱うためです。
- テキストが日本語で、言語も「ja」の場合は、そのまま日本語で問題と解説を作成してください。
- 言語が「en」（英語）の場合は、テキストの言語に関わらず、必ず全てのフラッシュカードのfront, back, frontRich, backRichを英語で作成してください。テキストが他の言語（日本語など）であっても、全ての内容を英語に翻訳して英語だけのフラッシュカードを作成してください。

---

【フラッシュカードの形式】:
JSON形式で以下の構造で返してください。

{ 
  "flashcards": [ 
    { 
      "front": "問題や質問文を記述（プレーンテキスト）", 
      "back": "答え・解説を記述（プレーンテキスト）",
      "frontRich": "問題や質問文をHTML形式で記述（リッチテキスト）", 
      "backRich": "答え・解説をHTML形式で記述（リッチテキスト）" 
    }, 
    { "front": "...", "back": "...", "frontRich": "...", "backRich": "..." } 
  ] 
}

- \`front\`と\`back\`には必ずプレーンテキスト版を記載してください（互換性のため）。
- \`frontRich\`と\`backRich\`にはHTML形式でリッチなフォーマットを適用してください：
  - 重要なポイントは<strong>タグや<mark>タグでハイライト
  - 箇条書きには<ul>と<li>タグを使用
  - 段落は<p>タグで分割
  - 見出しやサブセクションには<h4>、<h5>タグを使用可能
  - 例文や引用は<blockquote>タグを使用可能

使用可能なHTMLタグ: p, strong, em, mark, ul, ol, li, blockquote, h4, h5, br, code

---

【重要な注意点】:
1. テキストが英語だがユーザー指定言語が日本語の場合、**英語の文章をすべて機械的に和訳せず**、問題部分や例文は英語のまま活用してください。
2. ただし、日本語ユーザーが理解しやすいよう、解説や必要最低限の補足は日本語で行ってください。
3. テキストが日本語で、ユーザー指定言語も日本語の場合は、そのまま日本語で問題・解説を作成してください。
4. テキストの言語に関係なく、言語指定が「en」（英語）の場合は、必ず全ての内容を英語で作成してください。一切の日本語や他言語を使用せず、100%英語だけのフラッシュカードにしてください。日本語のテキストが含まれている場合でも、すべて英語に翻訳して英語のフラッシュカードを作成してください。
5. 言語の問題（英語学習など）の場合は、解説にできるだけ例文を表示するようにしてください。
6. **複雑さ（complexity）のレベルをきちんと反映**してください。
   - **simple**: 問題文と回答を短くまとめる（1～2文程度）。不要に詳細な解説は避ける。
   - **medium**: ポイントを押さえつつ適度なボリューム（2～4文程度）。例文やポイントの簡潔な補足を含む。
   - **detailed**: できる限り詳細に（4文以上の丁寧な解説）。必要に応じて複数の例文や箇条書きを交える。
7. **リッチテキスト形式で魅力的に整形してください**。
   - 重要なキーワードや概念には**太字**や<mark>ハイライト</mark>を適用してください。
   - 長い解説や複数のポイントがある場合は箇条書きを使用して整理してください。
   - 情報の階層構造を明確にするため、見出しやサブセクションを活用してください。
   - 例文や引用は引用ブロックを使用して視覚的に区別してください。`;
};
